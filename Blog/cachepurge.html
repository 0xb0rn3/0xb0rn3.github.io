<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Unauthorized Cache Purge — 0xb0rn3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --black:      #000000;
            --bg:         #111010;
            --bg-card:    #181716;
            --bg-field:   #1e1c1b;
            --bg-raised:  #252220;

            --gray-2:     #504945;
            --gray-3:     #3c3836;

            --fg:         #ebdbb2;
            --fg-muted:   #a89984;
            --fg-dim:     #665c54;
            --white:      #ffffff;

            --yellow:     #fabd2f;
            --orange:     #fe8019;
            --aqua:       #8ec07c;
            --red:        #fb4934;
            --blue:       #83a598;
            --purple:     #d3869b;

            --border:     rgba(235,219,178,.13);
            --border-mid: rgba(235,219,178,.28);
            --border-hi:  rgba(235,219,178,.6);

            --r-xs:   8px;
            --r-sm:   14px;
            --r:      20px;
            --r-lg:   28px;
            --r-pill: 999px;

            /* Post accent — purple for cache purge */
            --post-accent:      var(--purple);
            --post-accent-dim:  rgba(211,134,155,.1);
            --post-accent-border: rgba(211,134,155,.3);
        }

        *, *::before, *::after {
            margin: 0; padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--black);
            color: var(--fg);
            line-height: 1.8;
            overflow-x: hidden;
            position: relative;
        }

        /* Grain */
        body::before {
            content: '';
            position: fixed; inset: 0; z-index: 0;
            pointer-events: none; opacity: .028;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            background-size: 200px;
        }

        /* Dot grid */
        body::after {
            content: '';
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background-image: radial-gradient(circle, rgba(235,219,178,.045) 1px, transparent 1px);
            background-size: 32px 32px;
            animation: gridDrift 30s linear infinite;
        }
        @keyframes gridDrift {
            from { background-position: 0 0; }
            to   { background-position: 32px 32px; }
        }

        /* Rainbow top bar */
        .rainbow-bar {
            position: fixed; top: 0; left: 0; right: 0; height: 3px;
            background: linear-gradient(90deg, var(--yellow), var(--orange), var(--red), var(--aqua));
            z-index: 9999;
        }

        /* ═══════════════════════════════════════
           NAV
        ═══════════════════════════════════════ */
        .nav {
            position: fixed; top: 3px; left: 0; right: 0;
            z-index: 1000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(0,0,0,.88);
            border-bottom: 2px solid var(--border);
            transition: border-color .3s;
        }
        .nav.scrolled { border-bottom-color: var(--border-mid); }

        .nav-content {
            max-width: 1200px; margin: 0 auto;
            padding: .9rem 2rem;
            display: flex; align-items: center; justify-content: space-between;
        }

        .nav-logo {
            font-family: 'Orbitron', monospace;
            font-size: 1.1rem; font-weight: 900;
            color: var(--yellow); text-decoration: none;
            display: flex; align-items: center; gap: .6rem;
            letter-spacing: 2px; transition: color .2s;
        }
        .nav-logo:hover { color: var(--orange); }

        .nav-back {
            display: flex; align-items: center; gap: .6rem;
            font-size: clamp(.6rem,1.5vw,.7rem);
            font-weight: 700; color: var(--fg-muted);
            text-decoration: none;
            text-transform: uppercase; letter-spacing: 1.2px;
            padding: .4rem 1rem;
            border-radius: var(--r-pill);
            border: 1.5px solid var(--border-mid);
            background: var(--bg-card);
            box-shadow: 2px 2px 0 var(--gray-3);
            transition: all .22s ease;
        }
        .nav-back:hover {
            color: var(--purple);
            border-color: var(--post-accent-border);
            background: var(--post-accent-dim);
            transform: translate(-2px,-1px);
            box-shadow: 3px 3px 0 var(--gray-2);
        }
        .nav-back i { font-size: .65rem; }

        /* ═══════════════════════════════════════
           LAYOUT
        ═══════════════════════════════════════ */
        .page {
            position: relative; z-index: 10;
            max-width: 820px; margin: 0 auto;
            padding: clamp(5.5rem,11vh,8rem) clamp(1rem,4vw,2rem) clamp(3rem,7vh,5rem);
            animation: riseIn .9s cubic-bezier(.16,1,.3,1) .1s both;
        }

        @keyframes riseIn {
            from { opacity: 0; transform: translateY(28px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* ── Post header ── */
        .post-header {
            margin-bottom: clamp(2rem,5vh,3rem);
        }

        .post-meta-row {
            display: flex; align-items: center;
            flex-wrap: wrap; gap: .6rem;
            margin-bottom: 1.2rem;
        }

        .meta-pill {
            display: inline-flex; align-items: center; gap: 5px;
            padding: 3px 11px;
            border-radius: var(--r-pill);
            font-size: clamp(.5rem,1.3vw,.58rem);
            font-weight: 700;
            text-transform: uppercase; letter-spacing: 1px;
            border: 1.5px solid;
        }

        .pill-purple { color:var(--purple); border-color:rgba(211,134,155,.3); background:rgba(211,134,155,.08); }
        .pill-dim    { color:var(--fg-dim);  border-color:var(--border);        background:var(--bg-field); }
        .pill-red    { color:var(--red);     border-color:rgba(251,73,52,.3);   background:rgba(251,73,52,.08); }

        .post-title {
            font-family: 'Orbitron', monospace;
            font-size: clamp(1.5rem,5vw,2.6rem);
            font-weight: 900; color: var(--white);
            line-height: 1.15; letter-spacing: .04em;
            text-shadow: 4px 4px 0 var(--gray-3), 8px 8px 0 rgba(0,0,0,.5);
            margin-bottom: 1.2rem;
        }

        .post-desc {
            font-size: clamp(.78rem,2vw,.9rem);
            color: var(--fg-muted); line-height: 1.75;
            padding-left: 1rem;
            border-left: 3px solid var(--purple);
        }

        /* Divider */
        .divider {
            height: 1px; margin: clamp(1.5rem,4vh,2.5rem) 0;
            background: linear-gradient(90deg, transparent, var(--border-mid), transparent);
        }

        /* ═══════════════════════════════════════
           PROSE
        ═══════════════════════════════════════ */
        .prose { display: flex; flex-direction: column; gap: 0; }

        /* Section headings */
        .prose h2 {
            font-family: 'Orbitron', monospace;
            font-size: clamp(1rem,2.8vw,1.3rem);
            font-weight: 700; color: var(--white);
            text-transform: uppercase; letter-spacing: 1.5px;
            margin-top: clamp(2rem,5vh,3rem);
            margin-bottom: .9rem;
            display: flex; align-items: center; gap: .65rem;
        }

        /* Heading accent line */
        .prose h2::before {
            content: '';
            display: block; flex-shrink: 0;
            width: 3px; height: 1.1em;
            background: var(--purple);
            border-radius: 2px;
        }

        .prose p {
            font-size: clamp(.76rem,2vw,.88rem);
            color: var(--fg-muted); line-height: 1.85;
            margin-bottom: clamp(.9rem,2.5vh,1.3rem);
        }

        .prose strong { color: var(--fg); font-weight: 600; }

        /* Lists */
        .prose ol,
        .prose ul {
            margin: .4rem 0 clamp(.9rem,2.5vh,1.4rem) 0;
            padding-left: 0;
            list-style: none;
            display: flex; flex-direction: column; gap: .5rem;
        }

        .prose li {
            font-size: clamp(.74rem,1.9vw,.86rem);
            color: var(--fg-muted); line-height: 1.7;
            display: flex; align-items: flex-start; gap: .65rem;
            padding: .55rem .9rem;
            background: var(--bg-field);
            border: 1.5px solid var(--border);
            border-radius: var(--r-sm);
        }

        /* Bullet / number marker */
        .prose ul li::before {
            content: '›';
            color: var(--purple); font-weight: 700;
            font-size: 1rem; line-height: 1.5;
            flex-shrink: 0;
        }

        .prose ol {
            counter-reset: ol-counter;
        }
        .prose ol li {
            counter-increment: ol-counter;
        }
        .prose ol li::before {
            content: counter(ol-counter, decimal-leading-zero);
            color: var(--purple); font-weight: 700;
            font-size: .7rem; line-height: 1.9;
            flex-shrink: 0; letter-spacing: .5px;
        }

        .prose li strong { color: var(--fg); }

        /* Inline code */
        .prose code {
            font-family: 'JetBrains Mono', monospace;
            font-size: .88em;
            color: var(--yellow);
            background: rgba(250,189,47,.08);
            border: 1px solid rgba(250,189,47,.22);
            border-radius: var(--r-xs);
            padding: 1px 7px;
        }

        /* Terminal / command block */
        .cmd-block {
            background: var(--bg-field);
            border: 2px solid var(--border-mid);
            border-radius: var(--r);
            overflow: hidden;
            margin: clamp(.8rem,2.5vh,1.4rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .cmd-bar {
            display: flex; align-items: center; gap: 7px;
            padding: .6rem 1rem;
            background: var(--bg-raised);
            border-bottom: 1.5px solid var(--border);
        }
        .cmd-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .cmd-dot.r { background: #ff5f57; }
        .cmd-dot.y { background: #febc2e; }
        .cmd-dot.g { background: var(--aqua); }
        .cmd-title {
            font-size: clamp(.52rem,1.3vw,.6rem);
            color: var(--fg-dim); letter-spacing: 1.2px;
            text-transform: uppercase; flex: 1;
        }
        .cmd-body {
            padding: clamp(.9rem,2vw,1.2rem) clamp(1rem,2.5vw,1.4rem);
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(.72rem,1.9vw,.84rem);
            color: var(--aqua);
            letter-spacing: .3px;
        }
        .cmd-prompt { color: var(--yellow); font-weight: 700; margin-right: .5rem; }

        /* Figure / screenshots */
        .post-figure {
            margin: clamp(1rem,3vh,1.8rem) 0;
            background: var(--bg-card);
            border: 2px solid var(--border-mid);
            border-radius: var(--r-lg);
            overflow: hidden;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .post-figure img {
            width: 100%; display: block;
            object-fit: cover;
        }
        .post-figure figcaption {
            padding: .6rem 1rem;
            font-size: clamp(.55rem,1.4vw,.63rem);
            color: var(--fg-dim);
            letter-spacing: .8px;
            border-top: 1.5px solid var(--border);
            text-align: center;
        }

        /* Impact / callout card */
        .callout {
            background: var(--bg-card);
            border: 2px solid var(--border-mid);
            border-radius: var(--r-lg);
            overflow: hidden;
            margin: clamp(1rem,3vh,2rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .callout-stripe { height: 3px; background: linear-gradient(90deg,var(--purple),var(--blue)); }
        .callout-inner {
            padding: clamp(1rem,3vw,1.5rem);
        }
        .callout-head {
            display: flex; align-items: center; gap: 8px;
            font-family: 'Orbitron', monospace;
            font-size: clamp(.65rem,1.7vw,.76rem);
            font-weight: 700; color: var(--white);
            text-transform: uppercase; letter-spacing: 1.5px;
            margin-bottom: .75rem;
        }
        .callout-head i { color: var(--purple); font-size: .8rem; }

        /* ── Navigation footer ── */
        .post-nav {
            display: flex; align-items: center;
            justify-content: space-between;
            flex-wrap: wrap; gap: 1rem;
            margin-top: clamp(2.5rem,6vh,4rem);
            padding-top: clamp(1.5rem,4vh,2.5rem);
            border-top: 2px solid var(--border);
        }

        .post-nav-btn {
            display: inline-flex; align-items: center; gap: .6rem;
            font-size: clamp(.62rem,1.6vw,.72rem);
            font-weight: 700; color: var(--fg-muted);
            text-decoration: none;
            text-transform: uppercase; letter-spacing: 1px;
            padding: .55rem 1.2rem;
            border-radius: var(--r-pill);
            border: 1.5px solid var(--border-mid);
            background: var(--bg-card);
            box-shadow: 3px 3px 0 var(--gray-3);
            transition: all .22s ease;
        }
        .post-nav-btn:hover {
            color: var(--purple);
            border-color: var(--post-accent-border);
            background: var(--post-accent-dim);
            transform: translate(-2px,-2px);
            box-shadow: 5px 5px 0 var(--gray-2);
        }

        /* ═══════════════════════════════════════
           SCROLLBAR
        ═══════════════════════════════════════ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--black); }
        ::-webkit-scrollbar-thumb { background: var(--gray-2); border-radius: var(--r-pill); }
        ::-webkit-scrollbar-thumb:hover { background: var(--purple); }

        /* ═══════════════════════════════════════
           RESPONSIVE
        ═══════════════════════════════════════ */
        @media (max-width: 600px) {
            .post-title { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="rainbow-bar" aria-hidden="true"></div>

    <!-- ── Nav ── -->
    <nav class="nav" id="navbar">
        <div class="nav-content">
            <a href="../main.html" class="nav-logo">
                <i class="fas fa-terminal"></i>
                0xb0rn3
            </a>
            <a href="../blog.html" class="nav-back">
                <i class="fas fa-arrow-left"></i>
                Back to Blog
            </a>
        </div>
    </nav>

    <!-- ═══════════════════════════════════════
         POST
    ═══════════════════════════════════════ -->
    <main class="page">

        <!-- Header -->
        <header class="post-header">
            <div class="post-meta-row">
                <span class="meta-pill pill-purple"><i class="fas fa-calendar-alt"></i>August 2025</span>
                <span class="meta-pill pill-dim"><i class="fas fa-clock"></i>~4 min read</span>
                <span class="meta-pill pill-red"><i class="fas fa-exclamation-triangle"></i>DoS</span>
            </div>
            <h1 class="post-title">Unauthorized Cache Purge: DoS via HTTP Methods</h1>
            <p class="post-desc">
                Exploiting accessible PURGE HTTP methods without authentication — clearing website cache to cause
                performance degradation and denial of service conditions.
            </p>
            <div class="post-meta-row" style="margin-top:.9rem;">
                <span class="meta-pill pill-purple">Web Security</span>
                <span class="meta-pill pill-red">DoS</span>
                <span class="meta-pill" style="color:var(--blue);border-color:rgba(131,165,152,.3);background:rgba(131,165,152,.08);">HTTP Methods</span>
            </div>
        </header>

        <div class="divider"></div>

        <!-- Prose -->
        <div class="prose">

            <h2>Understanding Cache Purging</h2>
            <p>
                Cache purging is a legitimate CDN and caching server feature that removes cached content on demand.
                It's designed for administrators to force cache refreshes when content updates, clear stale data,
                or manage cache policies. The <code>PURGE</code> HTTP method provides this functionality.
            </p>
            <p>
                When properly configured, PURGE requests require authentication and authorization.
                When misconfigured, <strong>anyone can clear the cache</strong>.
            </p>

            <h2>Discovery</h2>
            <p>
                Testing for exposed HTTP methods is straightforward. A single <code>curl</code> request
                reveals whether PURGE is accessible:
            </p>

            <div class="cmd-block">
                <div class="cmd-bar">
                    <span class="cmd-dot r"></span>
                    <span class="cmd-dot y"></span>
                    <span class="cmd-dot g"></span>
                    <span class="cmd-title">terminal — purge test</span>
                </div>
                <div class="cmd-body">
                    <span class="cmd-prompt">$</span>curl -X PURGE https://target.com
                </div>
            </div>

            <figure class="post-figure">
                <img src="../Images/purge.png" alt="Successful PURGE response showing status ok">
                <figcaption>Response returned status "ok" with an operation ID — no authentication required.</figcaption>
            </figure>

            <p>
                The response came back with a status of <code>"ok"</code> and an operation ID.
                No authentication required. No authorization checks.
                The cache was cleared with a single unauthenticated request.
            </p>

            <h2>Impact</h2>

            <div class="callout">
                <div class="callout-stripe"></div>
                <div class="callout-inner">
                    <div class="callout-head"><i class="fas fa-bomb"></i>Attack Vectors Enabled</div>
                    <ol>
                        <li><strong>Performance degradation</strong> — all requests bypass cache and hit the origin server directly</li>
                        <li><strong>Origin server overload</strong> — sudden traffic spike as cache provides no protection</li>
                        <li><strong>Increased latency</strong> — users experience slow load times without cached content</li>
                        <li><strong>Resource exhaustion</strong> — origin servers may crash under unexpected load</li>
                        <li><strong>Cost implications</strong> — cloud-hosted services incur higher bandwidth and compute costs</li>
                    </ol>
                </div>
            </div>

            <h2>Scope Analysis</h2>
            <p>
                The vulnerability wasn't limited to a single endpoint. Testing revealed that PURGE worked
                across multiple paths. The wildcard pattern <code>/*</code> meant entire sections of the site
                could be cleared with one request.
            </p>

            <figure class="post-figure">
                <img src="../Images/purge_patterns.png" alt="Python script showing PURGE working on multiple endpoints">
                <figcaption>Automated test across discovered endpoints — every path responded successfully to PURGE.</figcaption>
            </figure>

            <p>
                A Python script automating requests across discovered endpoints showed every path
                responding successfully to PURGE requests. This wasn't a single misconfiguration —
                it was a <strong>systematic security failure across the entire caching infrastructure</strong>.
            </p>

            <h2>Attack Scenarios</h2>
            <ul>
                <li>Continuously purge cache to maintain denial-of-service conditions</li>
                <li>Target specific high-traffic pages during peak usage times</li>
                <li>Combine with other attacks to amplify impact</li>
                <li>Use automated scripts to persistently clear cache</li>
                <li>Focus on resource-intensive endpoints to maximize origin server load</li>
            </ul>

            <h2>Business Impact</h2>
            <ul>
                <li><strong>Revenue loss</strong> from degraded user experience and site slowdowns</li>
                <li><strong>Reputational damage</strong> as users encounter persistent performance issues</li>
                <li><strong>Increased operational costs</strong> from unexpected traffic patterns</li>
                <li><strong>Service disruption</strong> affecting availability SLAs</li>
            </ul>

            <h2>Proper Configuration</h2>
            <p>The PURGE method must be restricted to authorized administrative users. Hardening checklist:</p>
            <ul>
                <li>Require authentication for all PURGE requests</li>
                <li>Implement IP allowlisting for cache management</li>
                <li>Use API keys or tokens for cache operations</li>
                <li>Log all purge operations for audit trails</li>
                <li>Rate limit cache purge requests</li>
                <li><strong>Disable PURGE entirely if not needed</strong></li>
            </ul>

            <h2>Detection & Monitoring</h2>
            <ul>
                <li>Alert on PURGE method usage from unexpected source IPs</li>
                <li>Track cache hit ratios — alert on sudden drops</li>
                <li>Monitor origin server load for anomalous spikes</li>
                <li>Log and review all cache management operations</li>
            </ul>

            <p>
                Cache purging is a powerful administrative function. Like any privileged operation,
                it requires proper access controls. Without them, it becomes a denial-of-service
                vulnerability affecting every user of the service.
            </p>

        </div>

        <!-- Post nav -->
        <nav class="post-nav" aria-label="Post navigation">
            <a href="../blog.html" class="post-nav-btn">
                <i class="fas fa-arrow-left"></i>
                All Posts
            </a>
            <div style="display:flex;gap:.6rem;flex-wrap:wrap;">
                <span class="meta-pill pill-purple">Web Security</span>
                <span class="meta-pill pill-red">DoS</span>
                <span class="meta-pill" style="color:var(--blue);border-color:rgba(131,165,152,.3);background:rgba(131,165,152,.08);">HTTP Methods</span>
            </div>
        </nav>

    </main>

    <script>
    'use strict';
    window.addEventListener('scroll', () => {
        document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 60);
    }, { passive: true });
    </script>
</body>
</html>
